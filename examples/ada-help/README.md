# Embedding configuration files in Ada

This example shows how to you can embedd configuration files
in an Ada program.  The Advance Resource Embedder simply puts
the configuration files in a stream of bytes that can easily
be retrieved by a generated `Get_Content` function in the
generated `Config` package.

The configuration files are embedded by using the following
command:

```
are --lang=Ada -o src --resource=config --name-access --fileset '**/*' config
```

The `--lang=Ada` option selects the Ada generator for the output and the
`-o src` option indicates the target directory where files are generated.

The `--resource` option indicates the name of the resource and it is
used for the name of the target header and source file.  Hence, the tool will
generate the `config.ads` and the `config.adb` source files.  The `--name-access`
option tells the code generator to emit an Ada function that allows to retrieve
the resource by using its name.  To describe the content that is embedded,
a C structure is declared that gives information about the raw data content,
the content size, the modification date and data format.
The header file will declare the following structure and function declaration:

```C
struct config_content {
  const unsigned char *content;
  size_t size;
  time_t modtime;
  int format;
};

extern const struct config_content* config_get_content(const char* name);
```

The `--fileset '**/*'` option is here to define the pattern for files that
must be taken into account and embedded.  Then, the `config` directory is
scanned for files matching the given pattern.   Multiple `--fileset` patterns
can be specified.


# Build

Run the command

```
make
```

or

```
make ARE=../../bin/are
```

and this generates:

* src/config.ads: specification file file generated by *are*
* src/config.adb: embedded configuration file generated by *are*
* show_config: binary that prints the configuration file

