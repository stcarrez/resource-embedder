# Embedding configuration files in C

This example shows how to you can embed configuration files
in a C program.  The Advance Resource Embedder simply puts
the configuration files in an array of bytes that can easily
be retrieved by a generated `get_content` function.

The configuration files are embedded by using the following
command:

```
are --lang=c -o src --resource=config --name-access --fileset '**/*' config
```

The `--lang=c` option selects the C generator for the output and the
`-o src` option indicates the target directory where files are generated.

The `--resource` option indicates the name of the resource and it is
used for the name of the target header and source file.  Hence, the tool will
generate the `config.h` and the `config.c` source files.  The resource
name is also used to prefix the name of C functions and types.  The `--name-access`
option tells the code generator to emit a C function that allows to retrieve
the resource by using its name.  To describe the content that is embedded,
a C structure is declared that gives information about the raw data content,
the content size, the modification date and data format.
The header file will declare the following structure and function declaration:

```C
struct config_content {
  const unsigned char *content;
  size_t size;
  time_t modtime;
  int format;
};

extern const struct config_content* config_get_content(const char* name);
```

The `--fileset '**/*'` option is here to define the pattern for files that
must be taken into account and embedded.  Then, the `config` directory is
scanned for files matching the given pattern.   Multiple `--fileset` patterns
can be specified.


# Build

Run the command

```
make
```

or

```
make ARE=../../bin/are
```

and this generates:

* src/config.h: header file generated by *are*
* src/config.c: embedded configuration file generated by *are*
* show-config: binary that prints the configuration file

