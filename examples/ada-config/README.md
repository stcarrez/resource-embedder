# Embedding configuration files in Ada

This example shows how you can embed configuration files
in an Ada program.  The Advance Resource Embedder simply puts
the configuration files in a stream of bytes that can easily
be retrieved by a generated `Get_Content` function in the
generated `Config` package.

The configuration files are embedded by using the following
command:

```
are --lang=Ada -o src --resource=config --name-access --fileset '*.conf' config
```

The `--lang=Ada` option selects the Ada generator for the output and the
`-o src` option indicates the target directory where files are generated.

The `--resource` option indicates the name of the resource and it is
used for the name of the Ada package.  Hence, the tool will
generate the `config.ads` and the `config.adb` source files.  The `--name-access`
option tells the code generator to emit an Ada function that allows to retrieve
the resource by using its name.  To describe the content that is embedded,
an Ada record is declared that gives information about the raw data content,
the modification date and data format.
The Ada package specification contains:

```Ada
package Config is
   type Content_Access is access constant Ada.Streams.Stream_Element_Array;

   type Name_Access is access constant String;

   type Format_Type is (FILE_RAW, FILE_GZIP);

   type Content_Type is record
      Name    : Name_Access;
      Content : Content_Access;
      Modtime : Interfaces.C.long := 0;
      Format  : Format_Type := FILE_RAW;
   end record;

   Null_Content : constant Content_Type;

   function Get_Content (Name : in String) return Content_Type;
end Config;
```

The `--fileset '*.conf'` option is here to define the pattern for files that
must be taken into account and embedded.  Then, the `config` directory is
scanned for files matching the given pattern.   Multiple `--fileset` patterns
can be specified.


# Build

Run the command

```
make
```

or

```
make ARE=../../bin/are
```

and this generates:

* src/config.ads: specification file file generated by *are*
* src/config.adb: embedded configuration file generated by *are*
* show_config: binary that prints the configuration file

